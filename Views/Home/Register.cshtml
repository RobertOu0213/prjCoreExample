
@{
    ViewData["Title"] = "Register";
}

<h1>Register</h1>
@* <div id="divBox"></div> *@


<div class="row">
    <div class="col-3"></div>
    <div class="col-6">
        <h1>Register</h1>
        <form method="post" id="myForm">
            
            <div class="mb-3">
                <label for="InputName" class="form-label">姓名</label>
                <input type="text" class="form-control" id="InputName" name="name">

            </div>
            <div class="mb-3">
                <label for="InputEmail" class="form-label">電子郵件</label>
                <input type="email" class="form-control" id="InputEmail" name="email">
            </div>
            <div class="mb-3">
                <label for="InputAge" class="form-label">年紀</label>
                <input type="number" class="form-control" id="InputAge" name="age">
            </div>
            <div class="mb-3">
                <label for="formFile" class="form-label">圖片</label>
                <input class="form-control" type="file" id="formFile" name="image">
            </div>

            <button id="btn" type="submit" class="btn btn-primary">送出</button>
        </form>

    </div>
    <div class="col-3"></div>
</div>
<div id="div1"></div>

@section Styles {
    <style>

    </style>

}
@section Scripts {
    <script>

        (async () => {

            // const url = "@Url.Content("~/api/register")?name=Nayneo&age=35"
            // const res = await fetch(url);

            // const data = await res.text();
            // document.querySelector("#divBox").innerHTML = data;

        })();

        document.querySelector("#btn").addEventListener("click", async (e) => {
            e.preventDefault();
            const myForm = document.querySelector("#myForm");
            // const name = document.querySelector("#InputName").value;
            // const email = document.querySelector("#InputEmail").value;
            // const age = document.querySelector("#InputAge").value;

            // try {
            //     const url = `@Url.Content("~/api/register")?name=${name}&email=${email}&age=${age}`;
            //     const res = await fetch(url);
            //     if (!res.ok) throw new Error(`${res.status}`)
            // const datas =  await res.text();
            //     document.querySelector("#div1").innerHTML = datas;

            // } catch (err) {
            //     console.log(`${err.message}`);
            // }

            const formData = new FormData(myForm)
            // console.log(formData.entries());

            // for (const pair of formData.entries()) {

            // }

            try {
                const url = `@Url.Content("~/api/register")`;
                const res = await fetch(url, {
                    method:"POST",
                    body: formData
                });
                if (!res.ok) throw new Error(`${res.status}`)
                const datas = await res.text();
                document.querySelector("#div1").innerHTML = datas;

            } catch (err) {
                console.log(`${err.message}`);
            }



        })


    </script>
}
